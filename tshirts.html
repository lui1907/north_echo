<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>T-Shirts â€” North Echo</title>

<link rel="stylesheet" href="style.css" />
<link rel="stylesheet" href="support.css" />
<script src="menu.js" defer></script>
<script src="theme.js" defer></script>
<script src="support.js" type="module"></script>

<style>
.page-title { text-align:center; margin-top:40px; }
.tshirt-layout { display:flex; justify-content:center; align-items:flex-start; gap:60px; margin-top:30px; }
.product-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(230px,1fr)); gap:25px; justify-content:center; width:750px; }
.product-card { background:#0f0f0f; border:1px solid #222; border-radius:12px; padding:15px; text-align:center; transition:0.2s; text-decoration:none; color:white; }
.product-card:hover { transform:translateY(-4px); border-color:#00aa66; }
.product-card img { width:100%; height:260px; object-fit:cover; border-radius:8px; }
.filter-side { background:#0f0f0f; padding:20px; border-radius:10px; width:240px; border:1px solid #222; }
.search-box { width:100%; padding:8px; border-radius:6px; border:none; background:#111; color:white; margin-bottom:15px; }
.price-slider-box { margin:10px 0; }
.size-buttons { display:flex; gap:6px; margin-top:8px; }
.size-btn { background:#111; border:1px solid #333; color:white; padding:6px 12px; border-radius:5px; cursor:pointer; transition:0.2s; }
.size-btn.active { background:#00aa66; border-color:#00ff99; }
.toast { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) scale(0.9); background:rgba(20,20,20,0.95); border:1px solid #333; padding:16px 22px; color:white; border-radius:10px; opacity:0; transition:all .3s; z-index:99999; font-size:15px; }
.toast.show { opacity:1; transform:translate(-50%,-50%) scale(1); }
.toast.success { border-color:#00aa66; color:#00ff99; }
</style>
</head>

<body>

<header class="header">
  <div class="hamburger" id="menuBtn">â˜°</div>
  <a href="index.html" class="logo">NORTH ECHO</a>
  <div class="right-buttons">
    <a href="submit-design.html" class="submit-nav">Submit</a>
    <a href="cart.html" class="cart-icon">ðŸ›’ <span id="cartCount">0</span></a>
    <img src="assets/default-avatar.png" class="avatar" id="userAvatar">
  </div>
</header>

<h1 class="page-title">T-Shirts</h1>

<div class="tshirt-layout">
  <!-- SOL: ÃœRÃœNLER -->
  <div class="product-area">
    <div class="product-grid" id="productGrid"></div>
  </div>

  <!-- SAÄž: ARAMA + FÄ°LTRE -->
  <div class="filter-side">
    <input type="text" id="searchInput" class="search-box" placeholder="Search products...">
    <h3>Filters</h3>
    <h4>Price</h4>
    <input type="range" id="priceRange" min="0" max="1000" value="1000">
    <div class="price-value">Max: <span id="priceVal">1000</span>â‚º</div>

    <h4>Size</h4>
    <div class="size-buttons">
      <div class="size-btn" data-size="S">S</div>
      <div class="size-btn" data-size="M">M</div>
      <div class="size-btn" data-size="L">L</div>
      <div class="size-btn" data-size="XL">XL</div>
    </div>
  </div>
</div>

<!-- ðŸ’¬ SUPPORT -->
<div id="supportBtn" onclick="toggleSupportPanel()">
  <img src="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJ3aGl0ZSIgdmlld0JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnPjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuMDggMiAxMS4yNXY5LjI1YzAgMS4yOSAxLjA0IDIuNSAyLjUgMi41aDMuNXYzLjI1YzAgLjQyLjUyLjYzLjgzLjMzTDExLjY3IDIzaDQuODNjNS41MiAwIDEwLTQuMDggMTAtOS4yNVMxNy41MiAyIDEyIDJ6bTAgMkMxNi40MiA0IDIwIDcuMDggMjAgMTEuMjVzLTMuNTggNy4yNS04IDcuMjVoLTUuMTdsLTIuNjcgMi42N1YxOC40N0g0Yy0yLjIxIDAtNC0xLjc5LTQtNC4wNlYxMS4yNUM0IDcuMDggNy41OCA0IDEyIDR6Ii8+PC9nPjwvc3ZnPg==" alt="Support">
</div>
<div id="supportPanel"></div>

<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
const SUPABASE_URL = "https://xedfviwffpsvbmyqzoof.supabase.co";
const SUPABASE_KEY =
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhlZGZ2aXdmZnBzdmJteXF6b29mIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxMjM0NzMsImV4cCI6MjA3ODY5OTQ3M30.SK7mEei8GTfUWWPPi4PZjxQzDl68yHsOgQMgYIHunaM";
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

const grid = document.getElementById("productGrid");
const searchInput = document.getElementById("searchInput");
const priceRange = document.getElementById("priceRange");
const priceVal = document.getElementById("priceVal");
let selectedSize = null;

// ðŸ§© Verileri yÃ¼kle
async function loadProducts() {
  const { data, error } = await supabase.from("products").select("*").eq("category", "T-Shirts");
  if (error) return console.error(error);
  renderProducts(data);
}
loadProducts();

function renderProducts(data) {
  grid.innerHTML = data.map(p => `
    <a href="product.html?id=${p.id}" class="product-card" data-name="${p.name.toLowerCase()}" data-price="${p.price}">
      <img src="${(p.images || '').split(',')[0] || 'assets/noimg.png'}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>${p.price}â‚º</p>
    </a>
  `).join("");
}

// ðŸ” Arama
searchInput.addEventListener("input", applyFilters);
priceRange.addEventListener("input", applyFilters);

document.querySelectorAll(".size-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".size-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    selectedSize = btn.dataset.size;
    applyFilters();
  });
});

function applyFilters() {
  priceVal.textContent = priceRange.value;
  const searchText = searchInput.value.toLowerCase();
  const maxPrice = parseInt(priceRange.value);

  document.querySelectorAll(".product-card").forEach(card => {
    const name = card.dataset.name;
    const price = parseInt(card.dataset.price);
    const matchSearch = name.includes(searchText);
    const matchPrice = price <= maxPrice;
    if (matchSearch && matchPrice) card.style.display = "block";
    else card.style.display = "none";
  });
}
</script>

</body>
</html>
